@model  IOTLink.Diachinh.Models.LoginViewModel
@{
    ViewBag.Title = "Login";
    Layout = null;
}

<link href="~/Content/Map/lib/AdminLTE/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
<!-- Font Awesome -->
<link href="~/Content/Map/lib/AdminLTE/bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
<!-- Theme style -->
<link href="~/Content/Map/lib/AdminLTE/dist/css/AdminLTE.min.css" rel="stylesheet" />
<style>
    @@media (min-width: 768px) {
        .login-box, .register-box {
            width: 400px;
            /*min-width:600px;*/
        }

        .login-form {
            padding: 15px;
        }

        .register-logo {
            margin-bottom: 15px;
        }
    }

    .login-logo img {
        width: 50px
    }

    .title {
        text-align: center;
        font-size: 25px;
        line-height: 30px;
        font-family: 'Source Sans Pro', sans-serif !important;
        color: #354052;
    }

    .label-form-group {
        color: #7F8FA4;
    }

    .login-logo-lazo {
        width: 150px;
        padding-top: 76px;
    }

    .login-lazo-forget-password {
        color: #1A91EB;
        font-size: 14px;
        font-weight: bolder;
        padding-bottom: 20px;
    }

    .btn-lazo-login {
        background-color: #1A91EB;
        font-size: 16px;
        font-weight: 500;
        margin-bottom: 5px;
    }

    /*.version {
        text-align: center;
        margin-left: 130px;
    }*/

    /*@@media only screen and (max-width: 750px) {
        .version {
            text-align: center;
            margin-left: 276px;
        }
    }*/
</style>
<style>
    .login-box, .register-box {
        /*margin: 8% auto;*/
        margin: auto !important;
        transform: translateY(calc(50vh - 320px));
    }

    .validation-summary-errors.text-danger ul {
        padding: 0px;
    }

    .validation-summary-errors ul li {
        list-style-type: none;
    }
</style>
<title>Đăng nhập</title>
<body class="hold-transition login-page row">
    <div class="">
        <div class="login-box">

            <div>
                <div class="login-logo">
                    <a href="@Url.Action("index","home")">
                        <img src="~/images/logo.png" style="width: 250px;" />
                        @*<b>LAZO</b>*@
                    </a>
                </div>
            </div>
            <!-- /.login-logo -->
            <div class="login-box-body">
                <div class="form-login"></div>
                <h4 class="title">Đăng nhập hệ thống</h4>
                <br />
                @Html.AntiForgeryToken()
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                <div class="form-group has-feedback">
                    @Html.Label("Tên người dùng", htmlAttributes: new { @class = "control-label label-form-group" })
                    @Html.TextBoxFor(m => m.Username, new { @class = "form-control", placeholder = "Tên người dùng", autofocus = "autofocus" })
                    @Html.ValidationMessageFor(m => m.Username, "", new { @class = "text-danger" })
                    <span class="glyphicon glyphicon-user form-control-feedback"></span>
                </div>
                <div class="form-group has-feedback">
                    @Html.Label("Mật khẩu", htmlAttributes: new { @class = "control-label label-form-group" })
                    @Html.PasswordFor(m => m.Password, new { @class = "form-control", placeholder = "Nhập mật khẩu" })
                    @Html.ValidationMessageFor(m => m.Password, "", new { @class = "text-danger" })
                    <span class="glyphicon glyphicon-lock form-control-feedback"></span>
                </div>
                <div class="row">
                    <!-- /.col -->
                    <div class="col-xs-12 form-group">
                        <button type="submit" id="submit-form" class="btn btn-primary btn-block btn-flat btn-lazo-login" value="Log in">Đăng nhập</button>
                    </div>
                    <!-- /.col -->
                </div>

            </div>
            <!-- /.social-auth-links -->



        </div>
    </div>

    <script src="~/Content/Map/lib/AdminLTE/bower_components/jquery/jquery.min.js"></script>
    <!-- Bootstrap 3.3.7 -->
    <script src="~/Content/Map/lib/AdminLTE/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
</body>
<script src="~/Content/Map/js/sweetalert.min.js"></script>
<script>
            $(document).on('keyup', '#Username , #Password', function (e) {
                if (e.keyCode == 13) {
                    $('#submit-form').click();
                }
            });

            $(document).on('click', '#submit-form', function () {
                let username = $('#Username').val();
                let password = $('#Password').val();
                if (username.trim() == null || username.trim() == "" || password.trim() == null || password.trim() == "") {
                     swal({
                          title: "Thông báo",
                          text: "Đăng nhập thất bại! Thông tin đăng nhập không hợp lệ",
                          icon: "warning",
                          button: "Đóng",
                     }).then((value) => {

                     });
                    return;
                }
                var user = {
                    Username : username,
                    Password : password
                };
                $.ajax({
                    type: "POST",
                    url: "@Url.Action("Login", "Home")",
                    data: {
                        model: user,
                        returnUrl: window.location.search.replace('?returnUrl=', '').replace(/%2F/g, '/') + window.location.hash
                    },
                    success: function (result) {
                        if (!result.Status) {
                            swal({
                                title: "Thông báo",
                                text: result.Message,
                                icon: "error",
                                button: "Đóng",
                            }).then((value) => {

                            });
                            return;
                        } else {
                            window.location.href = window.location.origin + result.Message
                        }
                    },
                    error: function(error) {
                       console.log("ERROR:" + error);
                    }
                })
            })
</script>

